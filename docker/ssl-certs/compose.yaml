# ThaliumX SSL Certificate Service
# ================================
# Nginx + Certbot for Let's Encrypt SSL certificates
# This is a temporary service used to obtain and renew SSL certificates

services:
  nginx-acme:
    image: nginx:alpine
    container_name: thaliumx-nginx-acme
    hostname: thaliumx-nginx-acme
    restart: unless-stopped
    ports:
      - "80:80"
    volumes:
      - ./config/nginx-acme.conf:/etc/nginx/nginx.conf:ro
      - ./data/certbot/conf:/etc/letsencrypt:ro
      - ./data/certbot/www:/var/www/certbot
    networks:
      - thaliumx-net
    healthcheck:
      test: ["CMD", "nginx", "-t"]
      interval: 30s
      timeout: 10s
      retries: 3

  certbot:
    image: certbot/certbot:latest
    container_name: thaliumx-certbot
    hostname: thaliumx-certbot
    volumes:
      - ./data/certbot/conf:/etc/letsencrypt
      - ./data/certbot/www:/var/www/certbot
      - ./data/certbot/logs:/var/log/letsencrypt
    networks:
      - thaliumx-net

networks:
  thaliumx-net:
    external: true